name: "Mazdaspeed 6/Mazda 6 MPS/Mazdaspeed Atenza"
id: "mazdaspeed6"

rom_size: 1048576
endianness: "big"

baudrate: 500000

log_mode: "uds"

flash_offset: 0x8000
flash_size: 0xF8000

vins:
  - "JM1GG12L........."

transfer:
  flash_mode: "mazda1"
  download_mode: "mazda1"
  key: "MazdA"
  server_id: 0x7E0


# Tables
tables:
  - id: 0
    type: "1d"
    name: "Speed Limiter (fuel cut)"
    description: "Maximum speed before fuel is cut"
    data_type: "float32"
    category: "Limiters"
    width: 1
    
  - id: 1
    type: "1d"
    name: "Speed Limiter (Throttle close)"
    description: "Maximum speed before the throttle plate is closed"
    data_type: "float32"
    category: "Limiters"
    width: 1

  - id: 2
    type: "2d"
    name: "Some Timing Table"
    description: "Unknown"
    data_type: "float32"
    category: "Miscellaneous"
    width: 8
    height: 28
    axis_x_id: "rpm_500"
    axis_y_id: "load_3125"
    minimum: -20
    maximum: 60
    
  - id: 3
    type: "2d"
    name: "Maximum Ignition Timing (Open Loop)"
    description: "Maximum iginition timing during open loop operation"
    category: "Miscellaneous"
    data_type: "float32"
    width: 14
    height: 31
    axis_x_id: "rpm_500"
    axis_y_id: "load_125"
    minimum: -20
    maximum: 60
    
  - id: 4
    type: "1d"
    name: "Operating Load Limit 1"
    description: "Maximum permitted operating load"
    category: "Miscellaneous"
    data_type: "float32"
    width: 14
    axis_x_id: "rpm_500"
    minimum: 0
    maximum: 4
    
  - id: 5
    type: "2d"
    name: "Requested Load Multiplier Accel/Decel Adjustment 1st - 2nd Gear with APP Increase"
    description: "This table is used to reduce the load target during acceleration and shifting. Due to the inertia of the turbo it often overshoots the load target when accelerating and shifting. By anticipating the overshoot and reducing the load target, the actual target is more accurately achieved."
    category: "Load Targeting"
    data_type: "float32"
    width: 14
    axis_x_id: "rpm_500"
    height: 14
    axis_y_id: "rpm_500"
    minimum: 0.8
    maximum: 1

# Axes
axes:
  - id: "rpm_500"
    type: "linear"
    name: "RPM"
    minimum: 500
    increment: 500
    
  - id: "load_125"
    type: "linear"
    name: "Load"
    minimum: 0.125
    increment: 0.0625
    
  - id: "load_3125"
    type: "linear"
    name: "Load"
    minimum: 0.3125
    increment: 0.0625


# PIDs
pids:
  - id: 0
    name: "Coolant Temperature"
    description: "Coolant Temperature"
    code: 0x0005
    unit: "temp_celsius"
    formula: "a - 40"
    datatype: "float32"

  - id: 1
    name: "Engine RPM"
    description: "Engine RPM"
    code: 0x000C
    unit: "rpm"
    formula: "(256 * a + b) / 4"
    datatype: "float32"

  - id: 2
    name: "Vehicle speed"
    description: "Speed of the vehicle in km/h"
    code: 0x000D
    unit: "km/h"
    formula: "a"
    datatype: "float32"

  - id: 3
    name: "Absolute load"
    description: "The absolute load of the engine; how hard the engine is working"
    code: 0x0043
    unit: "none"
    formula: "(a * 256 + b) / 255"
    datatype: "float32"

  - id: 4
    name: "Accelerator pedal position"
    description: "How far the pedal position is depressed"
    code: 0x1340
    unit: "percentage"
    formula: "a * 1024 / 2601"
    datatype: "float32"

  - id: 5
    name: "Air-fuel equivalence ratio"
    description: "The ratio of actual AFR to stoichiometry for a given mixture. lambda = 1.0 is at stoichiometry, rich mixtures labmda < 1.0, and lean mixtures lambda > 1.0."
    code: 0x174f
    unit: "ratio"
    formula: "a / 128"
    datatype: "float32"

  - id: 6
    name: "Valve timing"
    description: "Timing advance in degrees of the camshafts"
    code: 0x16cd
    unit: "degrees"
    formula: "(a * 256 + b) / 16"
    datatype: "float32"

  - id: 7
    name: "Ambient air temperature"
    description: "Ambient air temperature"
    code: 0x0046
    unit: "temp_celsius"
    formula: "a - 40"
    datatype: "float32"

  - id: 8
    name: "Absolute Barometric pressure"
    description: "External atmospheric pressure"
    code: 0x0033
    unit: "pressure_kPa"
    formula: "a"
    datatype: "float32"

  - id: 9
    name: "Control module voltage"
    description: "Voltage supplied to ECU"
    code: 0x0042
    unit: "voltage"
    formula: "(256 * a + b) / 1000"
    datatype: "float32"

  - id: 10
    name: "Boost air temperature"
    description: "The temperature in the intake manifold"
    code: 0x1723
    unit: "temp_celsius"
    formula: "(a * 0.625) - 40"
    datatype: "float32"

  - id: 11
    name: "Fuel–Air commanded equivalence ratio"
    description: "The target fuel-air equivalence ratio"
    code: 0x0044
    unit: "ratio"
    formula: "2 * (256 * a + b) / 65536"
    datatype: "float32"

  - id: 12
    name: "Target engine RPM"
    description: "The engine RPM the ECU is targetting"
    code: 0x096e
    unit: "rpm"
    formula: "(a * 256 + b) / 4"
    datatype: "float32"

  - id: 13
    name: "Commanded throttle actuator"
    description: "The throttle position that the ECU is targetting"
    code: 0x004c
    unit: "percentage"
    formula: "a * 100 / 255"
    datatype: "float32"

  - id: 14
    name: "Fuel injection pulse width"
    description: "The time each injector is held open it its injection cycle"
    code: 0x1410
    unit: "time"
    formula: "(a * 256 + b) * 0.008"
    datatype: "float32"

  - id: 15
    name: "Fuel Rail Gauge Pressure"
    description: "The high pressure fuel rail's pressure"
    code: 0x0023
    unit: "pressure_kPa"
    formula: "10 * (256 * a + b)"
    datatype: "float32"

  - id: 16
    name: "Intake air temperature"
    description: "The temperature of air measured by the MAF sensor"
    code: 0x000f
    unit: "temp_celsius"
    formula: "a - 40"
    datatype: "float32"

  - id: 17
    name: "Knock retard"
    description: "The degrees that the spark timing is retarded as response to the knock sensor"
    code: 0x1746
    unit: "degrees"
    formula: "a * 0.3515625"
    datatype: "float32"

  - id: 18
    name: "Long term fuel trim"
    description: "The percentage difference from the base amount calculated from long term oxygen sensor measurements. Negative means fuel is reduced (too rich). Positive means fuel is added (too lean)."
    code: 0x0007
    unit: "percentage"
    formula: "a / 1.28 - 100"
    datatype: "float32"

  - id: 19
    name: "Short term fuel trim (primary)"
    description: "The short term fuel trim calculated from the primary oxygen sensor"
    code: 0x0006
    unit: "percentage"
    formula: "a / 1.28 - 100"
    datatype: "float32"

  - id: 19
    name: "Short term fuel trim (secondary)"
    description: "The short term fuel trim calculated from the secondary oxygen sensor"
    code: 0x163e
    unit: "percentage"
    formula: "(a * 256 + b) * 0.00012207031"
    datatype: "float32"

  - id: 21
    name: "Intake manifold absolute pressure"
    description: "The pressure of the intake manifold"
    code: 0x000b
    unit: "pressure_kPa"
    formula: "a"
    datatype: "float32"

  - id: 22
    name: "Mass air flow rate"
    description: "The flow rate of air measured by the MAF sensor"
    code: 0x0010
    unit: "grams/sec"
    formula: "(256 * a + b) / 100"
    datatype: "float32"

  - id: 23
    name: "MAF sensor voltage"
    description: "The voltage output by the MAF sensor"
    code: 0x1177
    unit: "voltage"
    formula: "(a * 256 + b) / 4096"
    datatype: "float32"

  - id: 24
    name: "Relative throttle position"
    description: "The throttle position relative to the learned closed position"
    code: 0x0045
    unit: "percentage"
    formula: "100 * a / 255"
    datatype: "float32"

  - id: 25
    name: "Timing advance"
    description: "The spark timing advance relative to TDC"
    code: 0x000e
    unit: "degrees"
    formula: "a / 2 - 64"
    datatype: "float32"

  - id: 26
    name: "Wastegate control solenoid duty cycle"
    description: "The duty cycle of the boost control solenoid."
    code: 0x16e1
    unit: "percentage"
    formula: "(a * 256 + b) * 100 / 65536"
    datatype: "float32"

  - id: 27
    name: "Fuel injection amount"
    description: "The amount of fuel injected in each cylinder per cycle"
    code: 0x1752
    unit: "fuel_injection"
    formula: "(a * 256 + b) / 32.728"
    datatype: "float32"

  - id: 28
    name: "Air to fuel ratio"
    description: "The air to fuel ratio measured by the wideband oxygen sensor"
    code: 0x174f
    unit: "ratio"
    formula: "a / 128 * 14.7"
    datatype: "float32"

  - id: 29
    name: "Fuel–Air commanded ratio"
    description: "The air to fuel ratio targeted by the ECU"
    code: 0x0044
    unit: "none"
    formula: "2 * (256 * a + b) / 65536 * 14.7"
    datatype: "float32"

  - id: 30
    name: "Clutch pedal position"
    description: "Clutch pedal position. 0 is released, 1 is depressed."
    code: 0xA211
    unit: "none"
    formula: "b % 1"
    datatype: "uint8"
  
  - id: 31
    name: "Neutral gear position"
    description: "0 - gearbox is in drive, 1 - gearbox is in neutral"
    code: 0xA211
    unit: "none"
    formula: "(a / 4) % 2"
    datatype: "uint8"

  - id: 32
    name: "MAP sensor voltage"
    description: "Voltage output by the MAP sensor"
    code: 0x0900
    unit: "voltage"
    formula: "(a * 256 + b) / 1024"
    datatype: "float32"

  - id: 33
    name: "Fuel pressure sensor voltage"
    description: "Voltage output by the fuel sensor"
    code: 0x168b
    unit: "voltage"
    formula: "(a * 256 + b) * 5 / 65535"
    datatype: "float32"

  - id: 34
    name: "Target fuel rail pressure"
    description: "The fuel rail pressure the ECU is targetting"
    code: 0x1747
    unit: "pressure_kPa"
    formula: "(a * 256 + b) * 10"
    datatype: "float32"

  - id: 35
    name: "Oxygen sensor voltage"
    description: "Voltage of the narrow band oxygen sensor"
    code: 0x0015
    unit: "voltage"
    formula: "a / 200"
    datatype: "float32"